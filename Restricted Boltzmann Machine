<p class="">Training Restricted Boltzmann Machines: An Introduction, Asja Fischer and Christian Igel</p><p class=""><br> </p><p class="">Energy of a configuration (v,h):</p><p class=""><br></p><p class=""></p><div class="equation"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow>
  <mi>E</mi>
  <mo stretchy="false">(</mo>
  <mi>v</mi>
  <mo>,</mo>
  <mi>h</mi>
  <mo stretchy="false">)</mo>
  <mo>=</mo>
  <mo>−<!-- − --></mo>
  <munder>
    <mo>∑<!-- ∑ --></mo>
    <mrow class="MJX-TeXAtom-ORD">
      <mi>i</mi>
      <mo>,</mo>
      <mi>j</mi>
    </mrow>
  </munder>
  <mrow class="MJX-TeXAtom-ORD">
    <msub>
      <mi>v</mi>
      <mi>i</mi>
    </msub>
    <msub>
      <mi>w</mi>
      <mrow class="MJX-TeXAtom-ORD">
        <mi>i</mi>
        <mi>j</mi>
      </mrow>
    </msub>
    <msub>
      <mi>h</mi>
      <mi>j</mi>
    </msub>
  </mrow>
  <mo>−<!-- − --></mo>
  <munder>
    <mo>∑<!-- ∑ --></mo>
    <mi>i</mi>
  </munder>
  <mrow class="MJX-TeXAtom-ORD">
    <msub>
      <mi>a</mi>
      <mi>i</mi>
    </msub>
    <msub>
      <mi>v</mi>
      <mi>i</mi>
    </msub>
  </mrow>
  <mo>−<!-- − --></mo>
  <munder>
    <mo>∑<!-- ∑ --></mo>
    <mi>j</mi>
  </munder>
  <mrow class="MJX-TeXAtom-ORD">
    <msub>
      <mi>b</mi>
      <mi>j</mi>
    </msub>
    <msub>
      <mi>v</mi>
      <mi>j</mi>
    </msub>
  </mrow>
</mrow><annotation encoding="math/tex">E(v,h) = - \sum_{i,j}{v_i w_{ij} h_j} - \sum_i{a_i v_i} - \sum_j{b_j v_j}</annotation></semantics></math></div><p class="">The probability distribution of a MRF <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics>
<mstyle displaystyle="true">
  <mi>X</mi>
  <mo>=</mo>
  <mrow>
    <mo>{</mo>
    <msub>
      <mi>X</mi>
      <mi>v</mi>
    </msub>
    <mo>}</mo>
  </mrow>
</mstyle>
<annotation encoding="math/asciimath">X = {X_v}</annotation></semantics></math> on an undirected graph <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics>
<mstyle displaystyle="true">
  <mi>G</mi>
  <mo>=</mo>
  <mrow>
    <mo>(</mo>
    <mi>V</mi>
    <mo>,</mo>
    <mi>E</mi>
    <mo>)</mo>
  </mrow>
</mstyle>
<annotation encoding="math/asciimath">G = (V, E)</annotation></semantics></math>:<br><br></p><p class=""></p><div class="equation"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow>
  <mi>P</mi>
  <mo stretchy="false">(</mo>
  <mi>x</mi>
  <mo stretchy="false">)</mo>
  <mo>=</mo>
  <mrow class="MJX-TeXAtom-ORD">
    <mfrac>
      <mrow>
        <munder>
          <mo>∏<!-- ∏ --></mo>
          <mi>c</mi>
        </munder>
        <mrow class="MJX-TeXAtom-ORD">
          <msub>
            <mi>ψ<!-- ψ --></mi>
            <mi>c</mi>
          </msub>
          <mo stretchy="false">(</mo>
          <msub>
            <mi>x</mi>
            <mi>c</mi>
          </msub>
          <mo stretchy="false">)</mo>
        </mrow>
      </mrow>
      <mi>Z</mi>
    </mfrac>
  </mrow>
  <mo>,</mo>
  <mi>Z</mi>
  <mo>=</mo>
  <munder>
    <mo>∑<!-- ∑ --></mo>
    <mi>x</mi>
  </munder>
  <mrow class="MJX-TeXAtom-ORD">
    <munder>
      <mo>∏<!-- ∏ --></mo>
      <mi>c</mi>
    </munder>
    <mrow class="MJX-TeXAtom-ORD">
      <msub>
        <mi>ψ<!-- ψ --></mi>
        <mi>c</mi>
      </msub>
      <mo stretchy="false">(</mo>
      <msub>
        <mi>x</mi>
        <mi>c</mi>
      </msub>
      <mo stretchy="false">)</mo>
    </mrow>
  </mrow>
  <mspace linebreak="newline"></mspace>
  <mi>P</mi>
  <mo stretchy="false">(</mo>
  <mi>x</mi>
  <mo stretchy="false">)</mo>
  <mo>=</mo>
  <mrow class="MJX-TeXAtom-ORD">
    <mfrac>
      <mn>1</mn>
      <msup>
        <mi>e</mi>
        <mrow class="MJX-TeXAtom-ORD">
          <mi>l</mi>
          <mi>n</mi>
          <mi>Z</mi>
        </mrow>
      </msup>
    </mfrac>
  </mrow>
  <msup>
    <mi>e</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mi>l</mi>
      <mi>n</mi>
      <mspace width="thinmathspace"></mspace>
      <mrow class="MJX-TeXAtom-ORD">
        <munder>
          <mo>∏<!-- ∏ --></mo>
          <mi>c</mi>
        </munder>
        <mrow class="MJX-TeXAtom-ORD">
          <msub>
            <mi>ψ<!-- ψ --></mi>
            <mi>c</mi>
          </msub>
          <mo stretchy="false">(</mo>
          <msub>
            <mi>x</mi>
            <mi>c</mi>
          </msub>
          <mo stretchy="false">)</mo>
        </mrow>
      </mrow>
    </mrow>
  </msup>
  <mo>=</mo>
  <mrow class="MJX-TeXAtom-ORD">
    <mfrac>
      <mn>1</mn>
      <msup>
        <mi>e</mi>
        <mrow class="MJX-TeXAtom-ORD">
          <mi>l</mi>
          <mi>n</mi>
          <mi>Z</mi>
        </mrow>
      </msup>
    </mfrac>
  </mrow>
  <msup>
    <mi>e</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <munder>
        <mo>∑<!-- ∑ --></mo>
        <mi>c</mi>
      </munder>
      <mrow class="MJX-TeXAtom-ORD">
        <mi>l</mi>
        <mi>n</mi>
        <mspace width="thinmathspace"></mspace>
        <mrow class="MJX-TeXAtom-ORD">
          <msub>
            <mi>ψ<!-- ψ --></mi>
            <mi>c</mi>
          </msub>
          <mo stretchy="false">(</mo>
          <msub>
            <mi>x</mi>
            <mi>c</mi>
          </msub>
          <mo stretchy="false">)</mo>
        </mrow>
      </mrow>
    </mrow>
  </msup>
  <mspace linebreak="newline"></mspace>
  <mi>P</mi>
  <mo stretchy="false">(</mo>
  <mi>x</mi>
  <mo stretchy="false">)</mo>
  <mo>=</mo>
  <mrow class="MJX-TeXAtom-ORD">
    <mfrac>
      <mn>1</mn>
      <msup>
        <mi>e</mi>
        <mrow class="MJX-TeXAtom-ORD">
          <mi>l</mi>
          <mi>n</mi>
          <mi>Z</mi>
        </mrow>
      </msup>
    </mfrac>
  </mrow>
  <msup>
    <mi>e</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo>−<!-- − --></mo>
      <mi>E</mi>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo>,</mo>
  <mi>E</mi>
  <mo stretchy="false">(</mo>
  <mi>x</mi>
  <mo stretchy="false">)</mo>
  <mo>=</mo>
  <mrow class="MJX-TeXAtom-ORD">
    <munder>
      <mo>∑<!-- ∑ --></mo>
      <mi>c</mi>
    </munder>
    <mrow class="MJX-TeXAtom-ORD">
      <mi>l</mi>
      <mi>n</mi>
      <mspace width="thinmathspace"></mspace>
      <mrow class="MJX-TeXAtom-ORD">
        <msub>
          <mi>ψ<!-- ψ --></mi>
          <mi>c</mi>
        </msub>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>x</mi>
          <mi>c</mi>
        </msub>
        <mo stretchy="false">)</mo>
      </mrow>
    </mrow>
  </mrow>
</mrow><annotation encoding="math/tex">P(x) = {\prod_c {\psi_c(x_c)} \over Z}, Z = \sum_x {\prod_c {\psi_c(x_c)}} \\
P(x) = {1 \over e^{lnZ}} e^{ln \, {\prod_c {\psi_c(x_c)}}} = {1 \over e^{lnZ}} e^{\sum_c {ln \, {\psi_c(x_c)}}} \\
P(x) = {1 \over e^{lnZ}} e^{-E(x)}, E(x) = {\sum_c {ln \, {\psi_c(x_c)}}}</annotation></semantics></math></div><p class=""><br></p><p class=""><br></p><p class=""><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics>
<mstyle displaystyle="true">
  <mo></mo>
</mstyle>
<annotation encoding="math/asciimath"></annotation></semantics></math> </p><p class=""><br></p><div class="equation"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow>
  <mi>E</mi>
  <mo stretchy="false">(</mo>
  <mi>v</mi>
  <mo>,</mo>
  <mi>h</mi>
  <mo stretchy="false">)</mo>
  <mo>=</mo>
  <mo>−<!-- − --></mo>
  <munder>
    <mo>∑<!-- ∑ --></mo>
    <mrow class="MJX-TeXAtom-ORD">
      <mi>i</mi>
      <mo>,</mo>
      <mi>j</mi>
    </mrow>
  </munder>
  <mrow class="MJX-TeXAtom-ORD">
    <msub>
      <mi>v</mi>
      <mi>i</mi>
    </msub>
    <msub>
      <mi>w</mi>
      <mrow class="MJX-TeXAtom-ORD">
        <mi>i</mi>
        <mi>j</mi>
      </mrow>
    </msub>
    <msub>
      <mi>h</mi>
      <mi>j</mi>
    </msub>
  </mrow>
  <mo>−<!-- − --></mo>
  <munder>
    <mo>∑<!-- ∑ --></mo>
    <mi>i</mi>
  </munder>
  <mrow class="MJX-TeXAtom-ORD">
    <msub>
      <mi>a</mi>
      <mi>i</mi>
    </msub>
    <msub>
      <mi>v</mi>
      <mi>i</mi>
    </msub>
  </mrow>
  <mo>−<!-- − --></mo>
  <munder>
    <mo>∑<!-- ∑ --></mo>
    <mi>j</mi>
  </munder>
  <mrow class="MJX-TeXAtom-ORD">
    <msub>
      <mi>b</mi>
      <mi>j</mi>
    </msub>
    <msub>
      <mi>v</mi>
      <mi>j</mi>
    </msub>
  </mrow>
</mrow><annotation encoding="math/tex">E(v,h) = - \sum_{i,j}{v_i w_{ij} h_j} - \sum_i{a_i v_i} - \sum_j{b_j v_j}</annotation></semantics></math></div><h3>Hopfield Network</h3>